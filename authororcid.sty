\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{authororcid}[2020/12/07 Author ORCID]

\RequirePackage{tikz}
\RequirePackage{xcolor}
%\RequirePackage{tocloft}
\RequirePackage{enumitem}

%\RequirePackage{tocloftedit}



%\makeatletter
%\providecommand{\@cfttocfinish}{}
%\makeatother


%%% tocloft 

%\def\@starttoc@latex@orig#1{%
% \begingroup
%   \makeatletter
%   \@input{\jobname.#1}%
%   \if@filesw
%     \expandafter\newwrite\csname tf@#1\endcsname
%     \immediate\openout \csname tf@#1\endcsname \jobname.#1\relax
%   \fi
%  \@nobreakfalse
%\endgroup}

%%% revtex

%\def\@starttoc#1{%
%  \begingroup
%    \toc@pre
%    \makeatletter
%    \@input{\jobname.#1}%
%    \if@filesw
%      \expandafter\newwrite\csname tf@#1\endcsname
%      \immediate\openout \csname tf@#1\endcsname \jobname.#1\relax
%    \fi
%    \@nobreakfalse
%    \toc@post
%  \endgroup
%}%



%\RequirePackage{tocloft}



%%% 'sans serif' option
%\DeclareOption{sans}{
%  \renewcommand{\familydefault}{\sfdefault}
%}
%
%%% 'roman' option
%\DeclareOption{roman}{
%  \renewcommand{\familydefault}{\rmdefault}
%}
%
%%% Global indentation option
%\newif\if@neverindent\@neverindentfalse
%\DeclareOption{neverindent}{
%  \@neverindenttrue
%}
%
%\ExecuteOptions{roman}

\ProcessOptions\relax


%%% The ORCID green color
%
\definecolor{orcidgreen}{rgb}{0.65098041,0.80784315,0.22352941}


%%% The ORCID logo, produced via tikzpicture.
%%%
%%% This code has been translated from the SVG version hosted on Wikipedia.
%
\newcommand{\orcidlogo}[1]{%
\resizebox{#1}{!}{%
\begin{tikzpicture}[scale=0.010]%
\fill [orcidgreen]
  (256,128)
    .. controls (256,57.3)  and (198.7,0)   .. (128,0)
    .. controls (57.3,0)    and (0,57.3)    .. (0,128) 
    .. controls (0,198.7)   and (57.3,256)  .. (128,256)
    .. controls (198.7,256) and (256,198.7) .. (256,128)
    ;

\fill [white]
  (86.3,69.8)--(70.9,69.8)
             --(70.9,176.9)
             --(86.3,176.9)
             --(86.3,128.5)
             --(86.3,69.8)
  ;

\fill [white]
  (88.7,199.2)
    .. controls (88.7,193.7) and (84.2,189.1) .. (78.6,189.1)
    .. controls (73,189.1)   and (68.5,193.7) .. (68.5,199.2)
    .. controls (68.5,204.8) and (73,209.3)   .. (78.6,209.3)
    .. controls (84.2,209.3) and (88.7,204.7) .. (88.7,199.2)
  ;

\fill [white]
  (108.9,176.9)
  --(150.5,176.9)
  .. controls (190.1,176.9) and (207.5,148.6) ..(207.5,123.3)
  .. controls (207.5,95.8) and (186,69.7) .. (150.7,69.7)
  --(108.9,69.7)
  --(108.9,176.9)
  (124.3,83.6)
  --(148.8,83.6)
  .. controls (183.7,83.6)  and (191.7,110.1) .. (191.7,123.3)
  .. controls (191.7,144.8) and (178,163)     .. (148,163)
  --(124.3,163)
  --(124.3,83.6)
  ;
\end{tikzpicture}%
}%
}


\newlength{\orcidlogowidth}
\setlength{\orcidlogowidth}{8pt}



%\newwrite\outputorcid
%\immediate\openout\outputorcid=\jobname.looi





\newwrite\orcidoutput
\immediate\openout\orcidoutput=\jobname.looi
%\immediate\write\orcidoutput{foo 1}
%\immediate\write\orcidoutput{foo 2}
%\immediate\write\orcidoutput{\string\textbf{foo 3}}
%\immediate\closeout\orcidoutput


%\def\frontmatter@maketitle@old\frontmatter@maketitle
%
%\def\frontmatter@maketitle{
%  \frontmatter@maketitle@old%
%  \immediate\closeout\outputstream%
%  }
\makeatletter
\def\@author@finish{%
 \frontmatterverbose@sw{\typeout{\string\@author@finish}}{}%
 \move@AU\move@AF
 \@ifx{\AU@grp\@empty}{%
  \@ifx{\CO@grp\@empty}%
 }{%
  \false@sw
 }%
 {}{%
  \@ifx{\AF@grp\@empty}{%
   \begingroup
    \let\href\@secondoftwo
    \let\AU@opr\@secondofthree
    \let\CO@opr\@secondofthree
    \let\footnote\@gobble
    \@ifx{\CO@grp\@empty}{%
     \class@warn{Assuming \string\noaffiliation\space for authors}%
     \frontmatterverbose@sw{\say\AU@grp}%
    }{%
     \class@warn{Assuming \string\noaffiliation\space for collaboration}%
     \frontmatterverbose@sw{\say\CO@grp}{}%
    }%
   \endgroup
   \@affil@none\move@AF
  }{}%
 }%
 \move@AUAF%
 %
 %%% new code:
 %
 \immediate\closeout\orcidoutput%
}%
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\makeatletter
\newcommand{\@format@export@orcid}[2]{%
  \@backslashchar item %
  #1: %name
  \@backslashchar href{https://orcid.org/#2}{#2}
  }
%
\def\@export@orcid#1{%
  \immediate\write\orcidoutput{#1}%
  }
\makeatother

\makeatletter
\newcommand*\orcid[1]{\begingroup\@orcid@def{#1}}%
\def\@orcid@def#1{%
 \endgroup%
% \show\@author
 \@author@add@orcid{#1}
}%
\makeatother


\makeatletter
\def\@author@add@orcid@#1#2#3{%
  %
  \@export@orcid{\@format@export@orcid{#1}{#3}}
  %
  \def\@author{{%
    #1%
    \hspace{0.5\orcidlogowidth}%
    \href{https://orcid.org/#3}{\orcidlogo{\orcidlogowidth}}%
    }{#2}}%
}%
\def\@author@add@orcid{\expandafter\@author@add@orcid@\@author}%
\makeatother


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\listoforcidids}{
  \section*[ORCID iDs]{ORCID \lowercase{i}D\lowercase{s}}
  \begin{itemize}[
    itemsep=-1mm,
    leftmargin=\dimexpr0.3cm+\labelsep\relax,
    label={\smash{\orcidlogo{8pt}}}
    ]
  \input{\jobname.looi}
  \end{itemize}
}



%\newcommand{\listorcidname}{Author ORCID iDs}
%\newlistof{authororcid}{loid}{\listorcidname}
%
%
%\newcommand{\authororcid}[1]{%
%\refstepcounter{authororcid}
%\par\noindent\textbf{authororcid \theanswer. #1}
%\addcontentsline{loid}{authororcid}{\protect\numberline{\theauthororcid}#1}\par}


%\makeatletter
%\renewcommand{\@cfttocfinish}{}
%\makeatother

%\newcommand{\listanswername}{List of Answers}
%\newlistof{answer}{ans}{\listanswername}
%
%\newcommand{\answer}[1]{%
%\refstepcounter{answer}
%\par\noindent\textbf{Answer \theanswer. #1}
%\addcontentsline{ans}{answer}{\protect\numberline{\theanswer}#1}\par}


%\newwrite\myoutput
%\immediate\openout\myoutput=\jobname.output

%\def\listoftables{\print@toc{lot}}%


\endinput



















