\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{authororcid}[2020/12/06 Author ORCID]

\RequirePackage{lmodern}

%% 'sans serif' option
\DeclareOption{sans}{
  \renewcommand{\familydefault}{\sfdefault}
}

%% 'roman' option
\DeclareOption{roman}{
  \renewcommand{\familydefault}{\rmdefault}
}

%% Global indentation option
\newif\if@neverindent\@neverindentfalse
\DeclareOption{neverindent}{
  \@neverindenttrue
}

\ExecuteOptions{roman}

\ProcessOptions\relax


%%% The ORCID green color
%
\definecolor{orcidgreen}{rgb}{0.65098041,0.80784315,0.22352941}


%%% The ORCID logo, produced via tikzpicture.
%%%
%%% This code has been translated from the SVG version hosted on Wikipedia.
%
\newcommand{\orcidlogo}[1]{%
\resizebox{#1}{!}{%
\begin{tikzpicture}[scale=0.010]%
\fill [orcidgreen]
  (256,128)
    .. controls (256,57.3)  and (198.7,0)   .. (128,0)
    .. controls (57.3,0)    and (0,57.3)    .. (0,128) 
    .. controls (0,198.7)   and (57.3,256)  .. (128,256)
    .. controls (198.7,256) and (256,198.7) .. (256,128)
    ;

\fill [white]
  (86.3,69.8)--(70.9,69.8)
             --(70.9,176.9)
             --(86.3,176.9)
             --(86.3,128.5)
             --(86.3,69.8)
  ;

\fill [white]
  (88.7,199.2)
    .. controls (88.7,193.7) and (84.2,189.1) .. (78.6,189.1)
    .. controls (73,189.1)   and (68.5,193.7) .. (68.5,199.2)
    .. controls (68.5,204.8) and (73,209.3)   .. (78.6,209.3)
    .. controls (84.2,209.3) and (88.7,204.7) .. (88.7,199.2)
  ;

\fill [white]
  (108.9,176.9)
  --(150.5,176.9)
  .. controls (190.1,176.9) and (207.5,148.6) ..(207.5,123.3)
  .. controls (207.5,95.8) and (186,69.7) .. (150.7,69.7)
  --(108.9,69.7)
  --(108.9,176.9)
  (124.3,83.6)
  --(148.8,83.6)
  .. controls (183.7,83.6)  and (191.7,110.1) .. (191.7,123.3)
  .. controls (191.7,144.8) and (178,163)     .. (148,163)
  --(124.3,163)
  --(124.3,83.6)
  ;
\end{tikzpicture}%
}%
}


\newlength{\orcidlogowidth}
\setlength{\orcidlogowidth}{8pt}




%\newcommand\orcid[1]{\def\@orcid{#1}}%
%\def\@orcid#1{%
% %\endgroup
% %\@AF@join{#1\href{mailto:#2}{#2}}%
%}%



%%%%%%%%%%%%%%%%%  Output routine  %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\makeatletter
%%
%\def\@author@present@script#1#2#3{%
% \begingroup
%  \gdef\comma@space{\textsuperscript{,\,}}%
%  \doauthor{#2}{#3}{\@affil@present@script}%
% \endgroup
% \advance\@tempcnta\m@ne
%}%
%%
%\def\@author@present@group#1#2#3{%
%  \gdef\comma@space{\gdef\comma@space{\textsuperscript{,\,}}}%
%  \doauthor{#2}{#3}{\@affil@present@group}%
%  \advance\@tempcnta\m@ne
%}%
%%
%\def\doauthor#1#2#3{%
%  \ignorespaces#1 eh\unskip\@listcomma
%  \begingroup
%   #3%
%  \@if@empty{#2}{\endgroup{}{}}{\endgroup{\comma@space}{}\frontmatter@footnote{#2}}%
%  \space \@listand
%}%
%\makeatother


%\makeatletter
%%
%%% #1 -> 0 throughout
%%% #2 -> author name
%%% #3 -> ??? should be the email/homepage/altaffil
%%
%\def\@author@present@script#1#2#3{%
% \begingroup
%  \gdef\comma@space{\textsuperscript{,\,}}%
%  %
%  %\message{debugging message }%
%  %\message{#2}
%  %\message{ close}%
%  %\show#1%
%  %
%  \doauthorworcid{#2}{\@author@orcid}{#3}{\@affil@present@script}%
% \endgroup
% \advance\@tempcnta\m@ne
%}%
%%
%\def\@author@present@group#1#2#3{%
%  \gdef\comma@space{\gdef\comma@space{\textsuperscript{,\,}}}%
%  \doauthorworcid{#2}{%
%    %%% whatever ends up in this argument within \@author@present@script above.
%  }{#3}{\@affil@present@group}%
%  \advance\@tempcnta\m@ne
%}%
%%
%\def\doauthorworcid#1#2#3#4{%
%  \ignorespaces#1%
%  \@if@empty{#2}{}{%
%%    \hspace{0.5\orcidlogowidth}%
%%    #2%
%%    \hspace{0.5\orcidlogowidth}%
%%    \href{https://orcid.org/}{\orcidlogo{\orcidlogowidth}}%
%    }%
%  \unskip\@listcomma
%  \begingroup
%   #4%
%  \@if@empty{#3}{\endgroup{}{}}{\endgroup{\comma@space}{}\frontmatter@footnote{#3}}%
%  \space \@listand
%}%
%\makeatother


%%%\doauthor{author}{email}{superscript affiliation}
%%%\doauthorworcid{author}{orcid}{email}{superscript affiliation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%% my attempts:

%\makeatletter
%\def\@orcid@cleared{{}}%
%%
%\def\@author@init{%
% \let\@author\@author@cleared
% \let\@author@orcid\@orcid@cleared
% \@booleanfalse\collaboration@sw
%}%
%\makeatother


%\makeatletter
%\def\@author@def#1#2{%
% \frontmatterverbose@sw{\typeout{\string\author\space\string\collaboration}}{}%
% \move@AU\move@AF\move@AUAF
% \let\@AF@join\@author@join
% #1%
% \def\@author{{#2}{}}%
% %
% \def\@author@orcid{{#2}{}}%
% %
%}%
%%
%\def\@author@orcid@join@#1#2#3{%
%  %\def\@author@orcid{{#1}{\@join{\@separator}{#3}}}%
%  \def\@author@orcid{{#1}{#3}}%
%}%
%\def\@author@orcid@join{\expandafter\@author@orcid@join@\@author@orcid}%
%\makeatother


\makeatletter
\newcommand*\orcid[1]{\begingroup\@orcid@def{#1}}%
\def\@orcid@def#1{%
% \@AF@join{#1\href{https://orcid.org/#2}{#2}}%
% \@author@join{#1\href{https://orcid.org/#2}{#2}}%
% \@author@join{a}{b}{c}
% \@author@orcid@join@{#1\href{https://orcid.org/#2}{#2}}
% \@author@orcid@join@{#1}
 \endgroup%
% \@author@orcid@join{#1}%
% \show\@author@orcid%
% \show\@author
 %%% defining \@author author name here?
 \@author@add@orcid{#1}
}%
\makeatother


%\def\@author@join@#1#2#3{%
%  \def\@author{{#1}{\@join{\@separator}{#2}{#3}}}%
%}%
%\def\@author@join{\expandafter\@author@join@\@author}%


\makeatletter
\def\@author@add@orcid@#1#2#3{%
  \def\@author{{%
    #1%
    \hspace{0.5\orcidlogowidth}%
    \href{https://orcid.org/#3}{\orcidlogo{\orcidlogowidth}}%
    }{#2}}%
}%
\def\@author@add@orcid{\expandafter\@author@add@orcid@\@author}%
\makeatother








%%%%% trying to take \frontmatter@author@produce apart:
%
%\makeatletter
%\def\frontmatter@author@produce@script{%
%  \begingroup
%    \let\@author@present\@author@present@script
%    \frontmatterverbose@sw{\typeout{\string\frontmatter@author@produce@script:}\say\@AAC@list\say\@AFF@list\say\@AFG@list}{}%
%    \let\AU@temp\@empty
%    \@tempcnta\z@
%    \let\AF@opr \@gobble
%    \def\AU@opr{\@author@count\@tempcnta}%
%    \def\CO@opr{\@collaboration@count\AU@temp\@tempcnta}%
%    \@AAC@list
%    \expandafter\CO@opr\@author@cleared
%    \begingroup
%     \frontmatter@authorformat
%     %\let\AF@opr \@affilID@def
%     \let\AU@opr \@author@present
%     %\def\CO@opr{\@collaboration@present\AU@temp}%
%     \set@listcomma@list\AU@temp
%     \@AAC@list %%% this seems to be a key part.
%     \unskip\unskip
%     \par
%    \endgroup
%%    \begingroup
%%     \frontmatter@above@affiliation@script
%%     \let\AFF@opr \@affil@script
%%     \@AFF@list
%%     \frontmatter@footnote@produce
%%     \par
%%    \endgroup
%  \endgroup
%}%
%\makeatother









%%%%%%%% from the package itself:

%\makeatletter
%\renewcommand\frontmatter@author{% implicit #1
% \@author@def{}% implicit #2}
%}%
%\makeatother



%\newcommand\frontmatter@author{% implicit #1
% \@author@def{}% implicit #2
%}%

%\def\@author@init{%
% \let\@author\@author@cleared
% \@booleanfalse\collaboration@sw
%}%
%
%
%%% â†‘ probably needs to be redefined to clear \@orcid






%\def\@author@def#1#2{%
% \frontmatterverbose@sw{\typeout{\string\author\space\string\collaboration}}{}%
% \move@AU\move@AF\move@AUAF
% \let\@AF@join\@author@join
% #1%
% \def\@author{{#2}{}}%
%}%
%\def\@author@join@#1#2#3{%
%  \def\@author{{#1}{\@join{\@separator}{#2}{#3}}}%
%}%
%\def\@author@join{\expandafter\@author@join@\@author}%


%\newcommand*\email[1][]{\begingroup\sanitize@url\@email{#1}}%
%\def\@email#1#2{%
% \endgroup
% \@AF@join{#1\href{mailto:#2}{#2}}%
%}%







\endinput



















